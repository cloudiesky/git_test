* spi
** 传输时序示例

SPI是一个环形总线结构，由ss(cs)、sck、sdi、sdo构成，
其时序其实很简单，主要是在sck的控制下，两个双向移位寄存器进行数据交换。

上升沿发送、下降沿接收、高位先发送。

上升沿到来的时候，sdo上的电平将被发送到从设备的寄存器中。

下降沿到来的时候，sdi上的电平将被接收到主设备的寄存器中。

假设主机和从机初始化就绪：并且主机的sbuff=0xaa (10101010)，从机的
sbuff=0x55 (01010101)，下面将分步对spi的8个时钟周期的数据情况演示一遍
(假设上升沿发送数据)。

| 脉冲 | 边沿 | 主机sbuff | 从机sbuff | sdi | sdo |
|------+------+-----------+-----------+-----+-----|
|    0 | 00-0 |  10101010 |  01010101 |   0 |   0 |
|------+------+-----------+-----------+-----+-----|
|    1 | 0--1 |  0101010x |  10101011 |   0 |   1 |
|    1 | 1--0 |  01010100 |  10101011 |   0 |   1 |
|------+------+-----------+-----------+-----+-----|
|    2 | 0--1 |  1010100x |  01010110 |   1 |   0 |
|    2 | 1--0 |  10101001 |  01010110 |   1 |   0 |
|------+------+-----------+-----------+-----+-----|
|    3 | 0--1 |  0101001x |  10101101 |   0 |   1 |
|    3 | 1--0 |  01010010 |  10101101 |   0 |   1 |
|------+------+-----------+-----------+-----+-----|
|    4 | 0--1 |  1010010x |  01011010 |   1 |   0 |
|    4 | 1--0 |  10100101 |  01011010 |   1 |   0 |
|------+------+-----------+-----------+-----+-----|
|    5 | 0--1 |  0100101x |  10110101 |   0 |   1 |
|    5 | 1--0 |  01001010 |  10110101 |   0 |   1 |
|------+------+-----------+-----------+-----+-----|
|    6 | 0--1 |  1001010x |  01101010 |   1 |   0 |
|    6 | 1--0 |  10010101 |  01101010 |   1 |   0 |
|------+------+-----------+-----------+-----+-----|
|    7 | 0--1 |  0010101x |  11010101 |   0 |   1 |
|    7 | 1--0 |  00101010 |  11010101 |   0 |   1 |
|------+------+-----------+-----------+-----+-----|
|    8 | 0--1 |  0101010x |  10101010 |   1 |   0 |
|    8 | 1--0 |  01010101 |  10101010 |   1 |   0 |
|------+------+-----------+-----------+-----+-----|

** 模式说明

CPOL是用来决定SCK时钟信号空闲时的电平，CPOL＝0，空闲电平为低电平，CPOL＝1时，
空闲电平为高电平。

CPHA是用来决定采样时刻的，CPHA=0，在每个周期的第一个时钟沿采样，CPHA＝1，在每
个周期的第二个时钟沿采样。

#+CAPTION: 四中模式（CPOL，CPHA）
#+ATTR_HTML: alt="四中模式（CPOL，CPHA）"
[[file:spi1.jpg]]

